#!/usr/bin/env bash

set -e

source $HOME/.zsh/exports.sh
source $HOME/.zsh/asdf.sh

asdf local nodejs 12.18.4

for input in $(ls -1 data/*.txt); do
  name=$(basename $input)
  output=data/json/"${name%.txt}.json"
  jq -R -s -c 'split("\n")' < $input > $output
done

npm publish --access=public

terminal-notifier \
  -message "Just published a new npm version." \
  -ignoreDnD \
  -title "email_data" \
  -group homebrew \
  &> /dev/null
